#!/usr/bin/env php
<?php

ini_set('display_errors', true);
error_reporting(E_ALL);
set_time_limit(0);
date_default_timezone_set('UTC');

// Always start in the project directory
chdir(dirname(__DIR__));

// Init autoloading
require 'autoload.php';

use Symfony\Component\Console\Application;

require 'bootstrap.php';

$cli = new \Cloud\Console\Application($app, 'cloudxxx', '0.1.0');

$cli->addCommands([
    new Cloud\Console\Command\Development\ServerCommand(),
    new Cloud\Console\Command\Doctrine\LoadFixturesCommand(),
    new Cloud\Console\Command\Resque\StartCommand(),
    new Cloud\Console\Command\Resque\EnqueueCommand(),
    new Cloud\Console\Command\Resque\ScheduleCommand(),
]);

/*
  $finder = new Finder();
  $finder
      ->files()
      ->in('src/Cloud/Job/')
      ->name('*.php')
  ;
  foreach ($finder as $file) {
      $className = 'Cloud\\Job\\' . str_replace('/', '\\', substr($file->getRelativePathname(), 0, -4));
      if (class_exists($className) && is_subclass_of($className, 'Cloud\Job\AbstractJob')) {
          $commands[] = new $className;
      }
  }
  $commands[] = new \CloudOutbound\YouPorn\Job\DemoCombined();
 */

$cli->run();
